# WebScreenshotExport Sample

Demonstrates exporting DataBlocks as screenshot images using the ScreenshotSink.

## Overview

This sample shows how to:
- Create basic screenshots using extension methods
- Generate high-resolution (2x) screenshots
- Export as PNG or JPEG with quality settings
- Customize styling with colors and CSS
- Configure viewport width for wide tables
- Control row limits for large datasets
- Generate screenshots in memory

## Key Features Demonstrated

### Basic Screenshot (Extension Method)

```csharp
// Quick screenshot to file
await data.ScreenshotToFileAsync(
    "output.png",
    rowLimit: 10,
    title: "My Report");

// Quick screenshot to memory
byte[] bytes = await data.ScreenshotAsync(rowLimit: 10, title: "Report");
```

### High-Resolution Screenshot

```csharp
// 2x scale for retina displays
byte[] highRes = await data.ScreenshotHighResAsync(
    rowLimit: 10,
    title: "High Resolution");
```

### JPEG with Quality

```csharp
await data.ScreenshotToFileAsync(
    "output.jpg",
    rowLimit: 10,
    title: "JPEG Export",
    format: ScreenshotFormat.Jpeg,
    quality: 85);  // 1-100
```

### Custom Styling with ScreenshotSink

```csharp
var sink = new ScreenshotSink
{
    RowLimit = 20,
    Title = "Custom Report",
    Subtitle = "Generated by My App",
    ViewportWidth = 1400,
    BackgroundColor = "#f8f9fa",
    HeaderBackgroundColor = "#2c3e50",
    HeaderTextColor = "#ffffff",
    UseAlternateRowColor = true,
    DeviceScaleFactor = 1.5
};

byte[] bytes = await sink.Transform(data);
```

### Custom CSS

```csharp
var sink = new ScreenshotSink
{
    Title = "Styled Report",
    CustomCss = @"
        body { background: #1a1a2e; }
        .title { color: #eee; }
        table { border-radius: 8px; }
        th { background-color: #16213e !important; }
        td { color: #ddd; }
    "
};
```

## How to Run

```bash
cd WebScreenshotExport
dotnet restore
dotnet run
```

## Expected Output

```
=== Datafication.WebConnector Screenshot Export Sample ===

Source URL: https://quotes.toscrape.com/

1. Extracting quote data...
   Extracted 10 quotes

2. Creating basic screenshot using extension method...
   Saved to: output/quotes_basic.png
   File size: ~150,000 bytes

3. Creating high-resolution screenshot (2x)...
   Saved to: output/quotes_highres.png
   File size: ~500,000 bytes

4. Creating JPEG screenshot with quality setting...
   Saved to: output/quotes_quality.jpg
   File size: ~50,000 bytes

5. Creating screenshot with custom styling...
   Saved to: output/quotes_custom.png

6. Creating screenshot with custom CSS...
   Saved to: output/quotes_css.png

7. Creating screenshot in memory (no file)...
   Created X bytes in memory
   PNG signature check: Valid PNG

8. Creating wide viewport screenshot...
   Saved to: output/quotes_wide.png

9. Demonstrating row limit options...
   Full (up to 100 rows): X bytes
   Limited (3 rows): Y bytes

10. Summary of generated files:
    Output directory: [path]/output
    - quotes_basic.png: X bytes
    - quotes_custom.png: X bytes
    - quotes_css.png: X bytes
    ...

=== Sample Complete ===
```

## Requirements

**Important**: This sample requires Puppeteer/Chromium for rendering. On first run, it will automatically download the browser binaries (~200MB).

## ScreenshotSink Properties

| Property | Default | Description |
|----------|---------|-------------|
| `RowLimit` | `100` | Maximum rows to include |
| `Format` | `Png` | Image format (Png or Jpeg) |
| `Quality` | `null` | JPEG quality 1-100 |
| `ViewportWidth` | `1200` | Browser viewport width |
| `FullPage` | `true` | Capture full page or viewport only |
| `DeviceScaleFactor` | `1` | Scale factor (2 for retina) |
| `Title` | `null` | Title above table |
| `Subtitle` | `null` | Subtitle below title |
| `BackgroundColor` | `#ffffff` | Page background color |
| `HeaderBackgroundColor` | `#4a5568` | Table header background |
| `HeaderTextColor` | `#ffffff` | Table header text color |
| `UseAlternateRowColor` | `true` | Zebra striping |
| `CustomCss` | `null` | Additional CSS styles |

## Extension Methods

| Method | Description |
|--------|-------------|
| `ScreenshotAsync(rowLimit, title)` | Returns PNG bytes |
| `Screenshot(rowLimit, title)` | Synchronous version |
| `ScreenshotToFileAsync(path, ...)` | Saves to file |
| `ScreenshotToFile(path, ...)` | Synchronous version |
| `ScreenshotHighResAsync(rowLimit, title)` | 2x scale PNG |

## Use Cases

- **Report Generation**: Create visual summaries of scraped data
- **Email Attachments**: Generate images for HTML emails
- **Dashboards**: Create preview thumbnails
- **Documentation**: Generate examples for docs
- **Archiving**: Visual snapshots of data at a point in time

## Performance Notes

- First run downloads browser (~200MB)
- PNG is larger but lossless
- JPEG is smaller with quality trade-off
- Higher DeviceScaleFactor = larger files
- Use RowLimit to control output size

## Related Samples

- **WebPdfExport** - Export to PDF format
- **WebQuoteScraping** - CSS selector scraping
- **WebProductScraping** - Product data extraction
